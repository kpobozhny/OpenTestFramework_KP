package pagesByDriver;

import org.apache.log4j.Logger;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import tools.WebActions;

import java.io.IOException;

import static tools.ConfigData.*;

/**
 * Created by kostyap on 7/25/2016.
 */
public class LoginPageByDriver {

    WebDriver driver;
    WebActions webActions;
    Logger log;
    WebDriverWait waitForCondition;

    //constructor
    public LoginPageByDriver(WebDriver driver) throws IOException {
        this.driver = driver;
        webActions = new WebActions(driver);
        log = Logger.getLogger(LoginPageByDriver.class);
        //explicitly wait
        waitForCondition = new WebDriverWait (driver, 5 );
        //implicitly wait
        //driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);

    }

    //Method to input a user name
    public void inputUserName (String userName) throws ClassNotFoundException, IOException, InstantiationException, IllegalAccessException {

        webActions.inputText("LoginPage.UserName", userName);
        log.info("'" + userName + "'" + " was entered into 'User name' field");
    }

    //Method to input a password
    public void inputPassword (String password) throws ClassNotFoundException, IOException, InstantiationException, IllegalAccessException {

        webActions.inputText("LoginPage.Password", password);
        //waitForCondition.until(ExpectedConditions.elementToBeClickable(By.xpath(LOGIN_BUTTON)));
        waitForCondition.until(ExpectedConditions.elementToBeClickable(ui("LoginPage.LoginButton")));
        log.info("'" + password + "'" + " was entered into 'Password' field");
    }

    //Metod to click on "log in" button
    public void clickLoginButton() throws ClassNotFoundException, IllegalAccessException, InstantiationException, IOException{
        webActions.clickButton("LoginPage.LoginButton");
        //waitForCondition.until(ExpectedConditions.presenceOfElementLocated(By.xpath(HomePageByDriver.LOGOUT_LINK)));
        waitForCondition.until(ExpectedConditions.presenceOfElementLocated(ui("HomePage.LogoutLink")));
        log.info("'log in' button was clicked");
    }

    //this method is used to check out that the 'Login' button is presented
    public boolean checkLoginButtonPresence() throws ClassNotFoundException, IllegalAccessException, InstantiationException, IOException{
        return webActions.isElementPresented("LoginPage.LoginButton");
    }
}
